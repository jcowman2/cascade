(this["webpackJsonpld47-cascade"]=this["webpackJsonpld47-cascade"]||[]).push([[0],{34:function(e,t,n){e.exports=n(48)},39:function(e,t,n){},40:function(e,t,n){},48:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),o=n(28),i=n.n(o),l=(n(39),n(52)),c=n(23),s=(n(40),n(2)),u=n(29),d=n.n(u),f=n(9),v=n.n(f),p=n(16),m=n.n(p),h=n(4),g=n(33),b="piece",y=g.a.colors,k=Object(h.a)({},y,{highlight:"gold"}),C=n(7),E=n(11),O=n.n(E),j=n(30),w=n.n(j),M=function(e){var t=Math.floor(e/12);return{x:e-12*t,y:t}},P=function(e,t){var n=M(t),r=Math.min.apply(Math,Object(C.a)(e.slots)),a=M(r),o=n.x-a.x,i=n.y-a.y,l=e.slots.map((function(e){var t=e+12*i,n=Math.floor(t/12);return(t+o)%12+12*n}));return Object(h.a)({},e,{slots:l})},x=a.a.createContext({boardCells:[],pieces:[],setPieces:function(){},setWindowPos:function(){},setDraggingPiece:function(){},setHoverCell:function(){},availableSlots:[],key:[],cascadeView:[],cascadeMatchesKey:!1}),S=d()(0,48).map((function(e){return{slot:e}})),D=[{id:0,slots:[17,18,19,31],kind:k.primary},{id:1,slots:[1,13,25,14,26],kind:k.primary},{id:2,slots:[30,42,43],kind:k.text}],W=[{slot:1,kind:k.primary},{slot:2,kind:k.primary},{slot:3,kind:k.text},{slot:4,kind:k.text},{slot:5,kind:k.primary},{slot:6,kind:k.primary}],R=function(e){var t=a.a.useState(S),n=Object(s.a)(t,2),r=n[0],o=(n[1],a.a.useState(D)),i=Object(s.a)(o,2),l=i[0],c=i[1],u=a.a.useState(),d=Object(s.a)(u,2),f=d[0],p=d[1],h=a.a.useState(),g=Object(s.a)(h,2),b=g[0],y=g[1],k=a.a.useState(),E=Object(s.a)(k,2),j=E[0],M=E[1],P=a.a.useState(W),R=Object(s.a)(P,2),H=R[0],I=(R[1],a.a.useMemo((function(){var e=null===b||void 0===b?void 0:b.id,t=v()(l.map((function(t){return t.id===e?[]:t.slots}))),n=r.map((function(e){return e.slot}));return m()(n,t)}),[b,l,r])),B=a.a.useMemo((function(){return function(e,t){for(var n=t?e.filter((function(e){return e.id!==t.id})):Object(C.a)(e),r=v()(n.map((function(e){return e.slots.map((function(t){return{slot:t,kind:e.kind}}))}))),a=O()(r,(function(e){return Math.floor(e.slot/12)})),o=[],i=function(e){var t=function(t){var n=a[t];if(!n)return"continue";var r=n.find((function(n){return n.slot===e+12*t}));return r?(o.push({slot:e,kind:r.kind}),"break"):void 0};e:for(var n=3;n>=0;n--){switch(t(n)){case"continue":continue;case"break":break e}}},l=0;l<12;l++)i(l);return o}(l,b)}),[l,b]),T=a.a.useMemo((function(){return function(e,t){return w()(e,t)}(B,H)}),[B,H]);return a.a.createElement(x.Provider,{value:{boardCells:r,pieces:l,setPieces:c,windowPos:f,setWindowPos:p,draggingPiece:b,setDraggingPiece:y,hoverCell:j,setHoverCell:M,availableSlots:I,key:H,cascadeView:B,cascadeMatchesKey:T}},e.children)},H=n(53),I=function(){var e=a.a.useContext(x),t=e.draggingPiece,n=e.hoverCell,r=e.availableSlots,o=!1,i=[];t&&void 0!==n&&(i=P(t,n).slots,m()(i,r).length||(o=!0));return{canDrop:o,potentialSlots:i}},B=function(){var e=I().canDrop,t=Object(H.a)({accept:b,canDrop:function(){return e}});return{dropRef:Object(s.a)(t,2)[1]}},T=function(){var e=a.a.useContext(x),t=e.boardCells,n=e.setWindowPos,r=e.hoverCell,o=I(),i=o.canDrop,l=o.potentialSlots;return{boardCells:t,setWindowPos:n,hoverCell:r,highlightedCells:i?l:[]}},V=function(e){var t=Math.random().toString(36);return"".concat(e,"_").concat(t.substr(2,8))},F=function(e){if(!e.length)return[];var t=e.shift(),n=[t],r=new Set;for(r.add(t);n.length;){var a=n.pop(),o=[a-12,a+12];a%12>0&&o.push(a-1),(a+1)%12>0&&o.push(a+1);for(var i=function(){var t=c[l],a=e.findIndex((function(e){return e===t}));a>-1&&(e.splice(a,1),n.push(t),r.add(t))},l=0,c=o;l<c.length;l++)i()}return Array.from(r)},J=function(e,t){var n=t?e.filter((function(e){return e.id!==t.id})):Object(C.a)(e),r=[],a=O()(n,"kind"),o=function(e){(function(e){for(var t=[];e.length>0;){var n=F(e);t.push(n)}return t})(v()(a[e].map((function(e){return e.slots})))).map((function(t){return{id:V("piece"),slots:t,kind:e}})).forEach((function(e){return r.push(e)}))};for(var i in a)o(i);return t&&r.push(t),r},K=function(e,t){var n=Math.floor(e/12);return(e-12*n+t)%12+12*n},A=function(){var e=a.a.useContext(x),t=e.pieces,n=e.setPieces,r=e.setDraggingPiece,o=e.windowPos,i=e.setHoverCell,l=e.hoverCell,c=e.draggingPiece,s=a.a.useCallback((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;n((function(t){var n=t.map((function(t){var n=t.slots.map((function(t){return K(t,e)}));return Object(h.a)({},t,{slots:n})}));return J(n,c)}))}),[c,n]),u=a.a.useCallback((function(e,t){r(e),o&&i(function(e,t){var n=t.x-e.x,r=t.y-e.y;return 12*Math.floor(r/80)+Math.floor(n/80)}(o,t))}),[r,i,o]),d=function(){r(void 0),i(void 0)};return{pieces:t,shiftRight:s,setDragPieceOffset:u,handlePieceDropped:function(e){console.log("dropped at",l),void 0!==l?(n((function(t){var n=t.map((function(t){return t.id===e.id?P(e,l):t}));return J(n,void 0)})),d()):console.error("handlePieceDropped",e,l)},handlePieceMissed:function(e){console.log("missed at",l),d()}}},L=function(e){var t=e.cells,n=e.renderCell;return a.a.createElement("div",{style:{position:"absolute"}},t.map((function(e){var t=e.slot,r=Math.floor(t/12),o=t-12*r;return a.a.createElement("div",{key:t,style:{position:"absolute",top:80*r,left:80*o,width:80,height:80}},n(e))})))},U=function(e){var t=e.slot,n=e.style,r=void 0===n?{}:n,o=e.showLabel,i=void 0!==o&&o;return a.a.createElement("div",{style:Object(h.a)({width:80,height:80,display:"flex",justifyContent:"center",alignItems:"center"},r)},i&&a.a.createElement("span",null,t))},$=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{isHidden:!1},n=t.isHidden,r=a.a.useCallback((function(t){var r=t.slot,o=e(r);return a.a.createElement(U,{slot:r,style:n?{display:"none"}:{backgroundColor:o}})}),[e,n]);return r},_=function(e){var t=e.style,n=void 0===t?{}:t,r=a.a.useContext(x).cascadeView,o=a.a.useCallback((function(e){return r.find((function(t){return t.slot===e})).kind}),[r]),i=$(o);return a.a.createElement("div",{style:Object(h.a)({width:960,height:80,borderWidth:1,borderStyle:"solid",borderColor:"text"},n)},a.a.createElement(L,{cells:r,renderCell:i}))},q=function(e){var t=e.style,n=a.a.useContext(x).key,r=a.a.useCallback((function(e){return n.find((function(t){return t.slot===e})).kind}),[n]),o=$(r);return a.a.createElement("div",{style:Object(h.a)({width:960,height:80,borderWidth:1,borderStyle:"solid",borderColor:"text"},t)},a.a.createElement(L,{cells:n,renderCell:o}))},z=n(32),G=function(e){var t=e.speed,n=e.playing,r=e.onShift,o=a.a.useState(!1),i=Object(s.a)(o,2),l=i[0],c=i[1],u=a.a.useState(0),d=Object(s.a)(u,2),f=d[0],v=d[1];return a.a.createElement(z.Timeline,{playing:n,endBehavior:"loop",defaultState:{flag:0},track:[{duration:2e3*t,state:{flag:{to:2}}}],value:f,onTick:function(e){var t=e.value;return v(t)},onUpdate:function(e){var t=e.state,n=!!Math.floor(t.flag);n!==l&&r(),c(n)}})},N=n(51),Q=n(54),X=n(27),Y=function(e){var t=e.slots,n=e.kind,r=e.id,o=A(),i=o.handlePieceDropped,l=o.handlePieceMissed,c=B().dropRef,u=Object(Q.a)({item:{type:b,slots:t,kind:n,id:r},end:function(e,t){e&&(t.didDrop()?i(e):l(e))},collect:function(e){return{isDragging:!!e.isDragging()}}}),d=Object(s.a)(u,3),f=d[0].isDragging,v=d[1],p=d[2];a.a.useEffect((function(){p(Object(X.a)(),{captureDraggingState:!0})}),[p]);var m=a.a.useMemo((function(){return t.map((function(e){return{slot:e}}))}),[t]),h=a.a.useCallback((function(){return n}),[n]),g=$(h,{isHidden:f});return a.a.createElement(a.a.Fragment,null,a.a.createElement("div",{ref:function(e){v(e),c(e)},style:{cursor:"move",position:"absolute"}},a.a.createElement(L,{cells:m,renderCell:g})))},Z=function(e){var t=e.piece,n=e.offset,r=t.slots,o=a.a.useMemo((function(){return r.map((function(e){return{slot:e}}))}),[r]),i=a.a.useCallback((function(){return t.kind}),[t]),l=$(i),c=a.a.useMemo((function(){var e=t.slots.map((function(e){return e%12}));return 80*Math.min.apply(Math,Object(C.a)(e))}),[t]),s=a.a.useMemo((function(){var e=t.slots.map((function(e){return e%4}));return 80*Math.min.apply(Math,Object(C.a)(e))}),[t]);return a.a.createElement("div",{style:{position:"fixed",top:n.y-s+24,left:n.x-c+24}},a.a.createElement(L,{cells:o,renderCell:l}))},ee=function(e){var t=e.pieces,n=A().setDragPieceOffset,r=Object(N.a)((function(e){return{item:e.getItem(),absoluteOffset:e.getClientOffset()}})),o=r.item,i=r.absoluteOffset;return a.a.useEffect((function(){o&&i&&n(o,i)}),[o,i,n]),a.a.createElement(a.a.Fragment,null,o&&i&&a.a.createElement(Z,{piece:o,offset:i}),t.map((function(e){return a.a.createElement(Y,{key:e.id,id:e.id,slots:e.slots,kind:e.kind})})))},te=function(e){var t=e.cells,n=T().highlightedCells,r=B().dropRef;return a.a.createElement("div",{ref:r},a.a.createElement(L,{cells:t,renderCell:function(e){var t=e.slot;return a.a.createElement(U,{key:t,slot:t,style:{backgroundColor:n.includes(t)?k.highlight:"inherit",opacity:.5}})}}))},ne=function(){var e=a.a.useState(),t=Object(s.a)(e,2),n=t[0],r=t[1],o=a.a.createRef();a.a.useEffect((function(){o.current&&setInterval((function(){if(o.current){var e=o.current.getBoundingClientRect();r(e)}}),1e3)}),[o]);var i=null===n||void 0===n?void 0:n.top,l=null===n||void 0===n?void 0:n.left;return{rect:n,divRef:o,top:i,left:l}},re=function(e){var t=e.boardCells,n=e.pieces,r=T().setWindowPos,o=ne(),i=o.top,l=o.left,c=o.divRef;a.a.useEffect((function(){void 0!==i&&void 0!==l&&r({x:l,y:i})}),[i,l,r]);var s=a.a.useCallback((function(e){var t=e.slot;return a.a.createElement(U,{slot:t})}),[]);return a.a.createElement("div",{style:{width:960,height:320,borderWidth:1,borderStyle:"solid",borderColor:"text"},ref:c},a.a.createElement(L,{cells:t,renderCell:s}),a.a.createElement(te,{cells:t}),a.a.createElement(ee,{pieces:n}))},ae=function(e){var t=T().boardCells,n=A(),r=n.pieces,o=n.shiftRight,i=a.a.useState(!1),l=Object(s.a)(i,2),c=l[0],u=l[1];return a.a.createElement("div",{style:{margin:"auto",display:"flex",justifyContent:"center",alignItems:"center",height:"100vh",flexDirection:"column"}},a.a.createElement(G,{speed:1,playing:c,onShift:o}),a.a.createElement(q,{style:{marginBottom:36}}),a.a.createElement(re,{boardCells:t,pieces:r}),a.a.createElement(_,{style:{marginTop:36}}),a.a.createElement("button",{onClick:function(){return u((function(e){return!e}))},style:{marginTop:24}},c?"Pause":"Play"))};var oe=function(){return a.a.createElement(l.a,{backend:c.a},a.a.createElement(R,null,a.a.createElement("div",null,a.a.createElement(ae,null))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(a.a.createElement(a.a.StrictMode,null,a.a.createElement(oe,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[34,1,2]]]);
//# sourceMappingURL=main.b5449197.chunk.js.map